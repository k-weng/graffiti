{"metadata":{"modules":{"imports":[],"exports":{"exported":[],"specifiers":[]}},"usedHelpers":[]},"ignored":false,"code":"Router.configure({\n  layoutTemplate: 'main',\n  loadingTemplate: 'loading',\n  notFoundTemplate: 'notFound',\n  yieldTemplates: {\n    nav: { to: 'nav' }\n  },\n  waitOn: function () {\n    console.log(\"subscribed\");\n    return [Meteor.subscribe('groups'), Meteor.subscribe('messages')];\n  }\n});\n\nvar requireLogin = function () {\n  if (!Meteor.user()) {\n    this.render(\"loginRequired\");\n  } else {\n    this.next();\n  }\n};\n\n//Router.route('/send',{name: 'messageSend'});\nRouter.map(function () {\n  this.route('home', { path: '/',\n\n    onBeforeAction: function () {\n      $('body').addClass('home');\n      this.next();\n    },\n\n    onStop: function () {\n      $('body').removeClass('home');\n    }\n\n  });\n  this.route('groupList', { path: '/groups' });\n});\n\nRouter.route('groups/:_id', {\n  name: 'groupPage',\n  data: function () {\n    return Groups.findOne(this.params._id);\n  }\n});\n\nvar goToGroups = function (pause) {\n  if (Meteor.userId()) {\n    Router.go('groupList');\n  } else {\n    this.next();\n  }\n};\n\nRouter.onBeforeAction(goToGroups, { only: ['home'] });\nRouter.onBeforeAction(function () {\n  $('body').addClass('body-home');\n  this.next();\n});\nRouter.onBeforeAction('dataNotFound', { only: 'groupPage' });\nRouter.onBeforeAction(function () {\n  var user = Meteor.user().username;\n  var currentGroupId = Router.current().params._id;\n  if (Groups.find({ _id: currentGroupId, people: { $in: [user] } }).count() === 0) {\n    Router.go('/');\n  } else {\n    this.next();\n  }\n}, { only: 'groupPage' });\nRouter.onBeforeAction(requireLogin, { only: 'messageSend' });\n\n// Router.plugin('ensureSignedIn', {\n//   only: ['groupPage']\n// });\n\n// AccountsTemplates.configureRoute('enrollAccount');\n// AccountsTemplates.configureRoute('signIn');\n// AccountsTemplates.configureRoute('signUp');","ast":null,"map":{"version":3,"sources":["/lib/router.js"],"names":[],"mappings":"AAAA,MAAM,CAAC,SAAS,CAAC;AAChB,gBAAc,EAAE,MAAM;AACtB,iBAAe,EAAE,SAAS;AAC1B,kBAAgB,EAAE,UAAU;AAC5B,gBAAc,EAAE;AACT,OAAG,EAAE,EAAC,EAAE,EAAE,KAAK,EAAC;GACnB;AACJ,QAAM,EAAE,YAAU;AACjB,WAAO,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;AAC1B,WAAO,CAAC,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,EAAE,MAAM,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC,CAAC;GAClE;CACD,CAAC,CAAC;;AAEH,IAAI,YAAY,GAAG,YAAU;AAC5B,MAAG,CAAC,MAAM,CAAC,IAAI,EAAE,EAAC;AACjB,QAAI,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC;GAC7B,MAAM;AACN,QAAI,CAAC,IAAI,EAAE,CAAC;GACZ;CACD,CAAA;;;AAGD,MAAM,CAAC,GAAG,CAAC,YAAW;AACpB,MAAI,CAAC,KAAK,CAAC,MAAM,EAAE,EAAC,IAAI,EAAE,GAAG;;AAE9B,kBAAc,EAAE,YAAW;AACtB,OAAC,CAAC,MAAM,CAAC,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;AAC3B,UAAI,CAAC,IAAI,EAAE,CAAC;KACb;;AAED,UAAM,EAAE,YAAW;AACjB,OAAC,CAAC,MAAM,CAAC,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;KAC/B;;GAEH,CAAC,CAAC;AACF,MAAI,CAAC,KAAK,CAAC,WAAW,EAAE,EAAC,IAAI,EAAE,SAAS,EAAC,CAAC,CAAC;CAC5C,CAAC,CAAC;;AAEH,MAAM,CAAC,KAAK,CAAC,aAAa,EAC1B;AACC,MAAI,EAAE,WAAW;AACjB,MAAI,EAAE,YAAW;AAChB,WAAO,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;GACvC;CACD,CAAC,CAAC;;AAEH,IAAI,UAAU,GAAG,UAAS,KAAK,EAAE;AAC/B,MAAI,MAAM,CAAC,MAAM,EAAE,EAAE;AACnB,UAAM,CAAC,EAAE,CAAC,WAAW,CAAC,CAAC;GACxB,MAAM;AACL,QAAI,CAAC,IAAI,EAAE,CAAC;GACb;CACF,CAAC;;AAEF,MAAM,CAAC,cAAc,CAAC,UAAU,EAAE,EAAC,IAAI,EAAE,CAAC,MAAM,CAAC,EAAC,CAAC,CAAC;AACpD,MAAM,CAAC,cAAc,CAAC,YAAW;AAC3B,GAAC,CAAC,MAAM,CAAC,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;AAChC,MAAI,CAAC,IAAI,EAAE,CAAC;CACjB,CAAC,CAAC;AACH,MAAM,CAAC,cAAc,CAAC,cAAc,EAAE,EAAC,IAAI,EAAE,WAAW,EAAC,CAAC,CAAC;AAC3D,MAAM,CAAC,cAAc,CAAC,YAAW;AAChC,MAAI,IAAI,GAAG,MAAM,CAAC,IAAI,EAAE,CAAC,QAAQ,CAAC;AAClC,MAAI,cAAc,GAAG,MAAM,CAAC,OAAO,EAAE,CAAC,MAAM,CAAC,GAAG,CAAC;AAC9C,MAAI,MAAM,CAAC,IAAI,CAAC,EAAC,GAAG,EAAE,cAAc,EAAE,MAAM,EAAE,EAAC,GAAG,EAAE,CAAC,IAAI,CAAC,EAAC,EAAC,CAAC,CAAC,KAAK,EAAE,KAAK,CAAC,EAAE;AAC5E,UAAM,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC;GACf,MAAM;AACH,QAAI,CAAC,IAAI,EAAE,CAAC;GACf;CACJ,EAAE,EAAC,IAAI,EAAG,WAAW,EAAC,CAAC,CAAC;AACzB,MAAM,CAAC,cAAc,CAAC,YAAY,EAAC,EAAC,IAAI,EAAC,aAAa,EAAC,CAAC,CAAC","file":"/lib/router.js.map","sourcesContent":["Router.configure({\n\tlayoutTemplate: 'main',\n\tloadingTemplate: 'loading',\n\tnotFoundTemplate: 'notFound',\n\tyieldTemplates: {\n        nav: {to: 'nav'}\n    },\n\twaitOn: function(){\n\t\tconsole.log(\"subscribed\");\n\t\treturn [Meteor.subscribe('groups'), Meteor.subscribe('messages')];\n\t}\n});\n\nvar requireLogin = function(){\n\tif(!Meteor.user()){\n\t\tthis.render(\"loginRequired\");\n\t} else {\n\t\tthis.next();\n\t}\n}\n\n//Router.route('/send',{name: 'messageSend'});\nRouter.map(function() {\n  this.route('home', {path: '/',\n\n\tonBeforeAction: function() {\n      $('body').addClass('home');\n      this.next();\n    },\n\n    onStop: function() {\n      $('body').removeClass('home');\n    }\n\t\n\t});\n  this.route('groupList', {path: '/groups'});\n});\n\nRouter.route('groups/:_id',\n{\n\tname: 'groupPage',\n\tdata: function() {\n\t\treturn Groups.findOne(this.params._id);\n\t}\n});\n\nvar goToGroups = function(pause) {\n  if (Meteor.userId()) {\n    Router.go('groupList');\n  } else {\n    this.next();\n  }\n};\n\nRouter.onBeforeAction(goToGroups, {only: ['home']});\nRouter.onBeforeAction(function() {\n      $('body').addClass('body-home');\n      this.next();\n});\nRouter.onBeforeAction('dataNotFound', {only: 'groupPage'});\nRouter.onBeforeAction(function() {\n\tvar user = Meteor.user().username;\n\tvar currentGroupId = Router.current().params._id;\n    if (Groups.find({_id: currentGroupId, people: {$in: [user]}}).count() === 0) {\n    \tRouter.go('/');\n    } else {\n        this.next();\n    }\n}, {only : 'groupPage'});\nRouter.onBeforeAction(requireLogin,{only:'messageSend'});\n\n\n\n// Router.plugin('ensureSignedIn', {\n//   only: ['groupPage']\n// });\n\n// AccountsTemplates.configureRoute('enrollAccount');\n// AccountsTemplates.configureRoute('signIn');\n// AccountsTemplates.configureRoute('signUp');\n"]},"hash":"b2da4464fe0bf1817f6f56291c19fa9112278672"}
